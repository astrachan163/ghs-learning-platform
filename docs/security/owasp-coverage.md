# OWASP Top 10 Coverage (v0.2)

This document maps the project's security controls to the OWASP Top 10 2021.

| Risk | Status | Mitigation | File(s) |
| :--- | :--- | :--- | :--- |
| **A01:2021-Broken Access Control** | **Mitigated** | Role-Based Access Control (RBAC) is enforced by middleware, checking for specific role claims in a validated JWT before allowing access to sensitive endpoints. | `middleware/rbac.ts`<br>`routes/authRoutes.ts` |
| **A02:2021-Cryptographic Failures** | **Partially Mitigated** | Example password hashing functions are implemented. All traffic must be over HTTPS in production. No sensitive data is stored at rest yet. | `security/crypto_examples.ts` |
| **A03:2021-Injection** | **Mitigated** | All input on sensitive endpoints is validated against a strict schema using a generic validation middleware. This prevents object injection and other payload-based attacks. Security tests verify this. | `middleware/validate.ts`<br>`schemas/authSchemas.ts`<br>`tests/security/injection.test.ts` |
| **A04:2021-Insecure Design** | **Ongoing** | A formal threat model is maintained and updated as new features are added, following a "security-as-code" practice. | `docs/threat-models/*` |
| **A05:2021-Security Misconfiguration** | **Planned** | Security headers (e.g., Helmet.js) and CORS policies will be explicitly configured before production deployment. | `backend/src/index.ts` |
| **A06:2021-Vulnerable and Outdated Components** | **Mitigated** | A Software Bill of Materials (SBOM) is generated on every build. The CI pipeline runs `npm audit` to check for known vulnerabilities in dependencies. | `.github/workflows/security-ci.yml` |
| **A07:2021-Identification and Authentication Failures** | **Mitigated** | Authentication is handled via Firebase Auth, using signed JWTs. A middleware validates the token on every authenticated request. | `middleware/auth.ts` |
| **A08:2021-Software and Data Integrity Failures** | **Mitigated** | A release manifest containing the git commit hash and artifact locations is generated by a script, providing a baseline for verifying deployment integrity. | `scripts/generate-release-manifest.sh` |
| **A09:2021-Security Logging and Monitoring Failures** | **Mitigated** | A structured logger is used. A trace middleware records every execution request to a central Firestore registry, providing an audit trail. | `utils/logger.ts`<br>`middleware/trace.ts`<br>`services/orchestrationRegistry.ts` |
| **A10:2021-Server-Side Request Forgery (SSRF)** | **Not Applicable** | The application does not currently make server-side requests to user-supplied URLs. | N/A |

(End of file)